{"version":3,"sources":["../../server/src/test/meal.js"],"names":["assert","chai","expect","use","chaiHTTP","API_PREFIX","catererPayload","name","email","phone","catering_service","password","caterer2Payload","caterer3Payload","before","done","Caterer","create","then","describe","it","request","app","get","res","to","have","status","equal","body","catch","err","console","log","message","findOne","where","caterer","id","token","jwt","sign","isCaterer","secret","expiresIn","set"],"mappings":"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","sourcesContent":["import fs from \"fs\";\nimport path from \"path\";\nimport chai from \"chai\";\nimport chaiHTTP from \"chai-http\";\nimport jwt from \"jsonwebtoken\";\nimport app from \"../app\";\nimport secret from \"../db/jwt_secret\";\nimport Caterer from \"../db/models/caterer\";\nimport Meal from \"../db/models/meals\";\n\nconst { assert, expect, use } = chai;\n\nuse(chaiHTTP);\n\nconst API_PREFIX = \"/api/v1\";\n\n\nconst catererPayload = {\n  name: \"Billy Newton\",\n  email: \"em@gd.com\",\n  phone: \"07075748392\",\n  catering_service: \"Buy Food\",\n  password: \"billions\"\n};\n\nconst caterer2Payload = {\n  name: \"Billy Newton\",\n  email: \"deakueem@gdyeyw.com\",\n  phone: \"07075748392\",\n  catering_service: \"Buy Food\",\n  password: \"billions\"\n};\n\nconst caterer3Payload = {\n  name: \"Billy Newton\",\n  email: \"de@gdye.com\",\n  phone: \"07075748392\",\n  catering_service: \"Buy Food\",\n  password: \"billions\"\n};\n\nbefore(done => {\n  Caterer.create(catererPayload).then(() => {\n    done();\n  });\n});\n\ndescribe(\"Caterer Get all Meals Endpoint Tests\", () => {\n  it(`GET ${API_PREFIX}/meals/ - Fetch All Meals (Unauthorized)`, done => {\n    chai\n      .request(app)\n      .get(`${API_PREFIX}/meals/`)\n      .then(res => {\n        expect(res).to.have.status(401);\n        assert.equal(res.body.status, \"error\");\n        done();\n      })\n      .catch(err => console.log(\"GET /meals/\", err.message));\n  });\n  it(`GET ${API_PREFIX}/meals/ - Fetch All Meals - (Caterer Authorized)`, done => {\n    Caterer.findOne({ where: { email: catererPayload.email } })\n      .then(caterer => {\n        const { id, name, email, } = caterer;\n        const token = jwt.sign(\n          {\n            caterer: { id, name, email, },\n            isCaterer: true\n          },\n          secret,\n          {\n            expiresIn: 86400\n          }\n        );\n        chai\n          .request(app)\n          .get(`${API_PREFIX}/meals/`)\n          .set(\"Authorization\", `Bearer ${token}`)\n          .then(res => {\n            expect(res).to.have.status(200);\n            assert.equal(res.body.status, \"success\");\n            done();\n          })\n          .catch(err => console.log(\"GET /meals/\", err.message));\n      })\n      .catch(err => console.log(err.message));\n  });\n});\n"],"file":"meal.js"}